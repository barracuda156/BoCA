<VideoSite>
  <name>Dailymotion</name>
  <version>1.0</version>
  <decoder>ffmpeg-m4v_audio-in</decoder>

  <script type="text/javascript">
    function canHandleURL(URL) {
      if (URL.toLowerCase().match(/http:\/\/www.dailymotion.com\/video\/.*/)) return true;
      else								      return false;
    }

    function getVideoURL(html) {
      var sequence = unescape((html.match(/.addVariable\("sequence",  "(.*?)"\);/), RegExp.$1));

      return (sequence.match(/"sdURL":"(.*?)"/), RegExp.$1).replace(/\\\//g, "/");
    }

    function queryMetadata(html) {
      var metadata = new Metadata();

      metadata.title	   = (html.match(/&lt;h1 class="dmco_title"&gt;&lt;span .*?&gt;(.*?)&lt;\/span&gt;&lt;\/h1&gt;/) ? RegExp.$1 : null);
 
      metadata.thumbnail   = (html.match(/&lt;link rel="thumbnail" type="image\/jpeg" href="(.*?)" \/&gt;/) ? "http://www.dailymotion.com" + RegExp.$1 : null);

      metadata.uploader	   = (html.match(/&lt;div class="user_container"&gt;.*?&lt;img\s+alt="(.*?)" .*?\/&gt;/) ? RegExp.$1 : null);

      return metadata;
    }
  </script>
</VideoSite>

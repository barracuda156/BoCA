<VideoSite>
  <name>Dailymotion</name>
  <version>1.0</version>
  <decoders>
    <decoder>avconv-m4v_audio-dec</decoder>
  </decoders>

  <script type="text/javascript">
    <![CDATA[
      function canHandleURL(URL) {
	if (URL.toLowerCase().match(/http:\/\/www.dailymotion.com\/video\/.*/)) return true;
	else									return false;
      }

      function getVideoURL(html) {
	var flashVars = unescape((html.match(/<param name="flashvars" value="(.*?)"\/>/), RegExp.$1));

	return unescape((flashVars.match(/"video_url":"(.*?)"/), RegExp.$1));
      }

      function queryMetadata(html) {
	var metadata = new Metadata();

	metadata.title	     = (html.match(/<meta property="og:title" content="(.*?)".*?\/>/) ? RegExp.$1 : null);
	metadata.description = (html.match(/<meta property="og:description" content="((?:.|\n|\r)*?)".*?\/>/) ? RegExp.$1 : null);

	metadata.date	     = (html.match(/<meta property="video:release_date" content="(.*?)T.*?".*?\/>/) ? RegExp.$1 : null);
	metadata.thumbnail   = (html.match(/<link rel="thumbnail" type="image\/jpeg" href="(.*?)" \/>/) ? "http://www.dailymotion.com" + RegExp.$1 : null);

	metadata.uploader    = (html.match(/<meta name="author" content="(.*?)".*?\/>/) ? RegExp.$1 : null);

	return metadata;
      }
    ]]>
  </script>
</VideoSite>

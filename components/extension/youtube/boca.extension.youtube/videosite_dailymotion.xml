<VideoSite>
  <name>Dailymotion</name>
  <version>1.0</version>
  <decoder>avconv-m4v_audio-in</decoder>

  <script type="text/javascript">
    <![CDATA[
      function canHandleURL(URL) {
	if (URL.toLowerCase().match(/http:\/\/www.dailymotion.com\/video\/.*/)) return true;
	else									return false;
      }

      function getVideoURL(html) {
	var sequence = unescape((html.match(/var flashvars = {.*?"sequence":"(.*?)".*?};/), RegExp.$1));

	return (sequence.match(/"sdURL":"(.*?)"/), RegExp.$1).replace(/\\\//g, "/");
      }

      function queryMetadata(html) {
	var metadata = new Metadata();

	metadata.title	   = (html.match(/<h1 class="dmco_title"><span .*?>(.*?)<\/span><\/h1>/) ? RegExp.$1 : null);

	metadata.thumbnail = (html.match(/<link rel="thumbnail" type="image\/jpeg" href="(.*?)" \/>/) ? "http://www.dailymotion.com" + RegExp.$1 : null);

	metadata.uploader  = (html.match(/<div class="user_container">.*?<img\s+alt="(.*?)" .*?\/>/) ? RegExp.$1 : null);

	return metadata;
      }
    ]]>
  </script>
</VideoSite>

<VideoSite>
  <name>Tudou 土豆网</name>
  <version>1.0</version>
  <decoder>ffmpeg-flv_audio-in</decoder>

  <script type="text/javascript">
    function canHandleURL(URL) {
      if (URL.toLowerCase().match(/http:\/\/www.tudou.com\/programs\/view\/.*/)) return true;
      else									 return false;
    }

    function getVideoURL(html) {
      var location = downloadURL("http://v2.tudou.com/v?it=" + (html.match(/var iid = ([0-9]+)/), RegExp.$1));

      return location.match(/&lt;f .*?&gt;(.*?)&lt;\/f&gt;/), RegExp.$1.replace(/&amp;amp;/g, "&amp;") + "&amp;vn=02";
    }

    function queryMetadata(html) {
      var metadata = new Metadata();

      metadata.title	   = (html.match(/&lt;span id="vcate_title"&gt;(.*?)&lt;\/span&gt;/) ? RegExp.$1 : null);
      metadata.description = (html.match(/&lt;div .*? id="videoDes"&gt;(.*?)&lt;\/div&gt;/) ? RegExp.$1 : null);

      metadata.date	   = (html.match(/&lt;div class="txt"&gt;.*?&lt;ul&gt;&lt;li&gt;.*?&lt;em&gt;(.*?)&lt;\/em&gt;&lt;\/li&gt;.*?&lt;\/ul&gt;.*?&lt;\/div&gt;/) ? RegExp.$1 : null);
      metadata.thumbnail   = (html.match(/bigItemUrl = "(.*?)"/) ? RegExp.$1 : null);

      metadata.uploader	   = (html.match(/&lt;div class="txt"&gt;&lt;p class="ds_a"&gt;.*?&lt;a .*?&gt;(.*?)&lt;\/a&gt;.*?&lt;\/p&gt;.*?&lt;\/div&gt;/) ? RegExp.$1 : null);

      return metadata;
    }
  </script>
</VideoSite>
